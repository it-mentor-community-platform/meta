# Командные процессы, Git Flow

## Состав команды

- Project Owner (Сергей [@zhukovsd](https://t.me/zhukovsd)) - формирование команды, постановка целей, документация, выстраивание процессов и коммуникации
- Lead (Вадим [@oneQwerty2](https://t.me/oneQwerty2)) - декомпозиция технической документации в задачи, коммуникация с исполнителями, ревью и приём pull request'ов
- Исполнители - работа над поставленными задачами, коммуникация с командой на созвонах и в чате. Набор ролей исполнителей может меняться от спринта к спринту в зависимости от текущих целей проекта

## Командные процессы

- Работа ведётся недельными спринтами
  - Каждый спринт проводится созвон команды для обсуждения текущих проблем и следующих целей
- Цикл работы над задачей
  - Project Owner формирует цели и пишет бизнес и техническую документацию
  - Lead выделяет из технической задачи конкретные задачи с декомпозицией и создаёт для них карточку в GitHub Project доске и GitHub Issue. Декомпозиция обеспечивает исполнителю понимания с чего начать, и что должно получиться
  - Исполнитель берёт задачу в работу, по необходимости уточняет требования. Когда всё готово, создаёт pull request
  - Lead берёт задачу в ревью, по необходимости запрашивает правки. Когда нужный уровень качества достигут, принимает pull request

## Git Flow и ветки

В проекте используется упрощённый Git Flow.

У каждого сервиса в проекте свой репозиторий с доской задач и issues и pull request'ами. Дополнительно создаются вспомогательные репозитории - для документации, локального стека, и прочих инфраструктурных вопросов.

Ветки репозиториев сервисов:
- `dev` - отсюда разработчики ответвляют feature ветки. Из `dev` собираются образы, использующиеся в локальных окружениях проекта
- `staging` - ветка, описывающая состояние сервиса для `staging` окружения
- `prod` - ветка, описывающая состояние сервиса для `prod` окружения

Цикл работы над задачей в разрезе веток:
- Взяв задачу в работу, разработчик создаёт ветку `feature-xxx-NNN` в нужном репозитории. `xxx` - краткое описание задачи, `NNN` - номер относящейся к задаче GitHub Issue. Пример - `feature-jwt-validation-7`. Изменения пушатся в ветку
- По готовности задачи разработчик создаёт pull request. Правки, при наличии, допушиваются в ту же ветку
- Lead делает ревью, когда нужный уровень качества достигнут, принимает pull request, изменения попадают в `dev`
- Для деплоя на `staging`, lead/project owner или разработчик создают pull request `dev` -> `staging`
- Для деплоя на `prod`, lead/project owner или разработчик создают pull request `staging` -> `prod`

Важные замечания:
- Если разработчику необходимо работать над задачей, которая опирается на ранее сделанную задачу, ещё не смердженную в dev, позволительно создать новую feature ветку от feature ветки предыдущей задачи
- В случае наличия конфликтов между `dev` и feature веткой, ответственностью разработчика является сделать merge dev'а в свою ветку
- История ветки не должна содержать мусорных коммитов на момент создания pull request. Если они есть, их необходимо почистить через rebase
- Pull request'ы принимаются через `merge --no-ff` для сохранения всей истории коммитов
- Feature ветка удаляется после приёма pull request'а

## Требования к коммитам

- Следуем [семантическим правилам](https://gist.github.com/iredun/ea7fb5aa3162102efe117d1043ad0863) написания коммит сообщений
- По-возможности, сообщение должно целиком описывать суть изменений. Сообщений вида "new stuff" быть не должно. Но не стоит перебарщивать и коммитить отдельно каждый чих
- Язык сообщений - русский или английский, по желанию разрабчика. Главное - консистентность в рамках репозитория (или всё на русском или всё на английском)
